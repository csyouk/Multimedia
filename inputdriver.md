# Input Driver
- 키보드, 터치, 마우스 등, 입력 장치에 대한 설정을 수행한다.
- 입력장치의 데이터 전송 흐름은 단방향이다.
- 하나의 이벤트를 바로 처리하는 것이 아니라, 계층을 만들어서 이벤트에 대한 처리를 수행하도록 한다.
- 다양한 유형의 입력장치를 구분하고, 입력장치에 대한 정보를 통일해서 단일한 드라이버에서 관리한다.
- 각 계층별로 인터페이스를 통해서 관심사를 분리시킨다.
  - 각 계층의 구성은 다음과 같다. 데이터의 흐름은 하단부(입력장치)부터 상단부(응용프로그램)로 흐르게 된다.
  - [응용 프로그램]
  - [입력 이벤트 드라이버]
  - [입력 장치 드라이버]
  - [입력 장치]
  -
- **커널의 코드는 외부에 의존성이 없다.**
  - 예를들면, `strcpy`함수를 사용하고 싶다면, c표준 라이브러리를 사용하는 것이 아니라,
  - 커널내부에 직접적으로 그 함수를 구현해서 사용한다.
  - 이렇게 설계하는 이유는 **안정성**의 측면이 크다.
  - 만약 커널이 외부 라이브러리를 사용한다고 하면, 시스템의 취약점을 이용해서 해킹을 할 가능성이 크다.
  - 결국 **보안**을 위해 이렇게 설계한다.

#### 입력장치 이벤트의 흐름
- 입력장치(마우스, 터치패드, 키보드)에 입력을 발생시킨다.
- 입력장치의 아날로그 입력값을 디지털 데이터로 변환시킨다.(ADC)
- 입력장치 드라이버에서는 입력값을 등록시킨다.(**set**, 구조체의 변수에 값을 할당)
  - 이때 입력값이 담기는 객체의 이름이 **input_dev** 이다.
- 입력이벤트 드라이버에 이벤트를 전송한다.(**register**)
- 이벤트를 구분하기 위해, **sync**를 시킨다.

- **시스템에 등록된 이벤트의 이름을 알고 싶다면 다음 명령어를 내린다.**
  - **`cat /sys/class/input/event#/device/name`**
  - `event#` : #에는 숫자가 들어간다.

#### insmod
- **in store module**
- 디바이스 드라이버를 커널에 동적으로 연결시키도록 도와주는 프로그램.
- 사용 예
  - `insmode devteset.ko`
    - `*.ko` : **kernel object**확장자를 뜻한다.
  - `rmmode devtest.ko`
    - remove module
- 커널이 디바이스 드라이버를 다 가지고 있다면 커널의 사이즈가 커진다.
- 따라서, 모듈형태로 드라이버를 따로 가지고 있다가, 필요할때 커널에 붙이고, 필요없으면 제거시키는 방식으로 작업한다.

#### 디바이스 드라이버의 Makefile
- [참고](./multimedia/EX04-03_platform_driver_input/Makefile)
- 일반 어플리케이션의 Makefile과 설정방법이 매우 다르다

#### 디바이스 드라이버를 커널에 포함시키는 방법.


#### ADC
- ADC가 10비트의 값이라는 뜻은, 아날로그 인풋을 10bit의 값으로 변환이 가능하다는 뜻이다.
- 즉, 디지털 값으로 바꾸면, 0 ~ 0x3ff 까지의 값을 가질 수 있다.
